---
title: "Code"
author: "Eric Chen, Junhan Li, & Daniel Fredin, Test"
output: pdf_document
---

```{r include=FALSE, echo=TRUE}
# Libraries
library(tidyverse)
library(ggplot2)
library(dplyr)
library(splitstackshape)
library(readr)

library(car)
library(lmtest)
library(rcompanion)
library(olsrr)

library(maps)
library(usmap)
```

```{r include=FALSE, echo=TRUE}
attorneys <- read.csv("attorneys.csv")
attorneys_time <- read.csv("attorneytimeentries.csv")
categories <- read.csv("categories.csv")
clients <- read.csv("clients.csv")
questionposts <- read.csv("questionposts.csv")
questions <- read.csv("questions.csv")
statesites <- read.csv("statesites.csv")
subcategories <- read.csv("subcategories.csv")
```

```{r}
clients <- clients %>%
  filter(Age != "NULL") %>%
  filter(MaritalStatus != "NULL") %>%
  filter(AnnualIncome != "NULL") %>%
  filter(SavingsBalance != "NULL") %>%
  filter(CheckingBalance != "NULL") %>%
  filter(AllowedIncome != "NULL") 

data_overall <- clients %>%
  select(StateAbbr, Age, NumberInHousehold, MaritalStatus, AnnualIncome, SavingsBalance, CheckingBalance, AllowedIncome)
  
```

```{r}
data_overall$Age <- as.integer(data_overall$Age)
data_overall$NumberInHousehold <- as.integer(data_overall$NumberInHousehold)
data_overall$AnnualIncome <- as.numeric(data_overall$AnnualIncome)
data_overall$AllowedIncome <- as.numeric(data_overall$AllowedIncome)
data_overall$CheckingBalance <- as.numeric(data_overall$CheckingBalance)
data_overall$SavingsBalance <- as.numeric(data_overall$SavingsBalance)
```

```{r}
cor(data_overall[,c(2,3,5,6,7,8)])
```

```{r}
table(categories$Category)
```




# Visualization 1

```{r}
top_subcats <- questions %>%
  group_by(Subcategory) %>%
  summarise(num_subcats = n()) %>%
  ungroup()

top_subcats <- top_subcats %>%
  arrange(desc(num_subcats)) %>%
  head(15)

ggplot(top_subcats, aes(x = num_subcats, y = reorder(Subcategory, num_subcats))) +
  geom_bar(stat = "Identity", fill = "#00A19B") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(title = "Top 15 Subcategories",
       x = "Number of Clients",
       y = "Category")

```

# Visualization 2


# Visualization 3

